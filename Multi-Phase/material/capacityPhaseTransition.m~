function [ h ] = capacityPhaseTransition( x, t, xEnd, numberOfLayers,...
    tEnd, numberOfTimeStepsPerLayer, T, specificHeat, rho, entalphyJump,...
    Tliq, Tmel)
%CAPACITYPHASETRANSITION returns the thermal capacity for the
%liquid and the solid part. K. C. Mills, "Recommended Values of
%Thermophysic Properties for selected commercial alloys", 2002.

deltaT = tEnd /(numberOfLayers*numberOfTimeStepsPerLayer);
timeStep_layer = ceil(t/deltaT/numberOfTimeStepsPerLayer);
deltaX = xEnd/numberOfLayers;
boundaryConditionPoint = deltaX * timeStep_layer;
h = zeros(numel(x), 1);

for i=1:numel(x)
    
    %    if T > 0.0 &&  T < Tmel
    %        h(i) = rho * specificHeat;
    %    elseif T >= Tmel  &&  T <= Tliq
    %        h(i) = rho * specificHeat + rho * entalphyJump / (10);
    %    else
    %        h(i) = rho * specificHeat + rho * entalphyJump;
    %    end
    
%     h(i) = rho * specificHeat + rho * entalphyJump / 2 / (Tliq-Tmel) *...
%         (tanh( (T - Tmel) / 10) + 1);

    h(i) = rho * specificHeat + rho * entalphyJump*...
        (tanh( (T - Tmel) / 10) + 1) * ;
    
end

end


function f_pc = phaseChangeFunc(T, Tmel)

if T <= Tmel
    f_pc = 0.0;
else
    f_pc = 1.0;
end

end